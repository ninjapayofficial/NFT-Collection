<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Token Deployment</title>
  <link rel="stylesheet" href="styles.css"> <!-- Link to your CSS file if any -->
</head>
<body>
  <div class="container">
    <h1>Deploy NFT</h1>
    <p>Please click "Connect Wallet" and approve the connection request in MetaMask.</p>
    <!-- Connect Wallet Button -->
    <button id="connectWalletButton">Connect Wallet</button>
    <form id="deployForm" class="form">
      <label for="name">Token Name:</label>
      <input type="text" id="name" name="name" required><br>
      <label for="symbol">Token Symbol:</label>
      <input type="text" id="symbol" name="symbol" required><br><br>
      <input type="submit" value="Deploy">
    </form>
    
    <div id="loader" class="loader" style="display: none;"></div> <!-- Loader -->
    <h2 id="message" class="message"></h2> <!-- Placeholder for messages -->
  </div>

  <!-- Use type="module" to enable ESM imports -->
  <script type="module">
    // Import Thirdweb SDK and ethers.js using esm.sh
    import { ThirdwebSDK } from 'https://esm.sh/@thirdweb-dev/sdk@4.0.99?bundle';
    import { ethers } from 'https://esm.sh/ethers@5.7.2';

    let provider;
    let signer;
    let sdkInstance; // Renamed to avoid conflicts

    // Your Thirdweb Client ID and Secret Key
    const CLIENT_ID = '690062c61fec9aa02c8f0d8d84e2dc99'; // Replace with your actual Client ID
    const SECRET_KEY = 'WA7-QDoWghPpkIgjmKWtvUGSOgzD9c06_lDqUzcEK50o_9bdGo9u5fGm1aAp7lBRqdxp0fJ74NFRWeIp0ahTiA'; // Replace with your actual Secret Key

    // Verify if Thirdweb SDK and ethers are loaded
    console.log('Thirdweb SDK:', ThirdwebSDK);
    console.log('ethers:', ethers);

    // Connect Wallet
    document.getElementById('connectWalletButton').addEventListener('click', async () => {
      const connectButton = document.getElementById('connectWalletButton');
      connectButton.disabled = true;
      connectButton.innerText = 'Connecting...';

      if (window.ethereum) {
        try {
          await window.ethereum.request({ method: 'eth_requestAccounts' });
          provider = new ethers.providers.Web3Provider(window.ethereum);
          signer = provider.getSigner();

          // Initialize Thirdweb SDK with Client ID and Secret Key
          sdkInstance = new ThirdwebSDK(signer, {
            clientId: CLIENT_ID,
            secretKey: SECRET_KEY
          });

          console.log('Wallet connected');
          document.getElementById('message').innerText = 'Wallet connected';

          // Optionally hide the connect button
          connectButton.style.display = 'none';

          // Check network
          const network = await provider.getNetwork();
          console.log('Connected network:', network.name);
          document.getElementById('message').innerText += ` | Network: ${network.name}`;
        } catch (error) {
          console.error('Error connecting wallet:', error);
          const errorMessage = error.code === 4001 
            ? 'Connection request rejected by user.' 
            : 'An unexpected error occurred.';
          document.getElementById('message').innerText = `Error: ${errorMessage}`;
          connectButton.disabled = false;
          connectButton.innerText = 'Connect Wallet';
        }
      } else {
        console.error('MetaMask is not installed.');
        document.getElementById('message').innerText = 'MetaMask is not installed.';
        connectButton.disabled = false;
        connectButton.innerText = 'Connect Wallet';
      }
    });

    // Listen for account changes
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', (accounts) => {
        if (accounts.length === 0) {
          document.getElementById('message').innerText = 'Please connect to MetaMask.';
          sdkInstance = null;
        } else {
          signer = provider.getSigner();
          sdkInstance = new ThirdwebSDK(signer, {
            clientId: CLIENT_ID,
            secretKey: SECRET_KEY
          });
          document.getElementById('message').innerText = 'Wallet connected';
        }
      });

      window.ethereum.on('chainChanged', (chainId) => {
        window.location.reload();
      });
    }

    // Deploy NFT Collection
    document.getElementById('deployForm').addEventListener('submit', async (event) => {
      event.preventDefault();

      if (!sdkInstance) {
        document.getElementById('message').innerText = 'Please connect your wallet first.';
        return;
      }

      // Show loader
      document.getElementById('loader').style.display = 'block';
      document.getElementById('message').innerText = '';

      const name = document.getElementById('name').value;
      const symbol = document.getElementById('symbol').value;

      try {
        // Deploy the contract
        const contractAddress = await sdkInstance.deployer.deployBuiltInContract(
          "nft-collection",
          {
            name: name,
            symbol: symbol,
            primary_sale_recipient: ethers.constants.AddressZero,
            image: "https://example.com/your-image.png",
            description: "This is Nin Token",
            external_link: "https://ninjapay.in",
            platform_fee_recipient: ethers.constants.AddressZero,
            platform_fee_basis_points: 100 // 1%
          },
          "5.0.2", // Specify the version
          {
            gasLimit: 5000000, // Set a higher gas limit if needed
          }
        );

        console.log("NFT Contract deployed to:", contractAddress);
        const etherscanLink = `https://sepolia.etherscan.io/address/${contractAddress}`;
        document.getElementById('message').innerHTML = `Contract deployed to: <a href="${etherscanLink}" target="_blank">${contractAddress}</a>`;
      } catch (error) {
        console.error('Error deploying contract:', error);
        const errorMessage = error.reason || error.message || 'Unknown error during deployment.';
        document.getElementById('message').innerText = `Deployment Error: ${errorMessage}`;
      } finally {
        // Hide loader
        document.getElementById('loader').style.display = 'none';
      }
    });
  </script>
</body>
</html> -->
